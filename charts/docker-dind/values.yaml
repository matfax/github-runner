replicaCount: 1
image:
  repository: ghcr.io/matfax/github-runner/docker-dind
  pullPolicy: IfNotPresent
  tag: "@sha256:02d268592320d0495a5106fd280c31eb114193be19516fbc8b9c60b8dac20381"
imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""
service:
  type: ClusterIP
  clusterIP: "None" # Headless service - DNS resolves directly to pod/node IP
  port: 2375
  targetPort: 2375
  annotations: {}
# Docker daemon configuration
docker:
  # TCP host binding
  host: "tcp://0.0.0.0:2375"
  # Insecure registries (private registry access)
  insecureRegistries:
    - "10.0.0.0/8"
    - "172.16.0.0/12"
    - "192.168.0.0/16"
  # Explicit data directory for Docker (images, layers, containers)
  # Must match persistence.mountPath for cache to persist
  dataRoot: "C:/docker-data"
  # Builder configuration
  builder:
    gc:
      # Default storage limit for build cache
      defaultKeepStorage: "32GB"
      # Enable garbage collection
      enabled: true
  # Additional daemon options
  extraArgs: []
# Resource requests and limits
resources:
  limits:
    cpu: 2000m
    memory: 4Gi
  requests:
    cpu: 500m
    memory: 1Gi
# Node selector for Windows nodes
nodeSelector:
  kubernetes.io/os: windows
  kubernetes.io/arch: amd64
# Tolerations for Windows nodes
tolerations:
  - key: "os"
    operator: "Equal"
    value: "windows"
    effect: "NoSchedule"
# Affinity for scheduling
affinity: {}
# Pod security context - DinD requires privileged
podSecurityContext: {}
# Host network - Use host network namespace for Docker-in-Docker
# Required for proper network access and Docker daemon functionality
hostNetwork: true
# Security context - Windows hostProcess for accessing host containerd
securityContext:
  windowsOptions:
    hostProcess: true
    runAsUserName: "NT AUTHORITY\\SYSTEM"
# Liveness probe - using Docker API health check
livenessProbe:
  tcpSocket:
    port: 2375
  initialDelaySeconds: 60
  periodSeconds: 30
  timeoutSeconds: 10
  successThreshold: 1
  failureThreshold: 3
# Readiness probe
readinessProbe:
  tcpSocket:
    port: 2375
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  successThreshold: 1
  failureThreshold: 3
# Service account configuration
serviceAccount:
  create: true
  annotations: {}
  name: ""
# Pod annotations
podAnnotations: {}
# Pod labels
podLabels: {}
# Persistence for Docker data (images, containers, volumes, build cache)
persistence:
  enabled: false
  existingClaim: ""
  storageClass: ""
  accessMode: ReadWriteOnce
  size: 50Gi
  # Must match docker.dataRoot below
  mountPath: C:/docker-data
# Windows firewall configuration
firewall:
  enabled: true
  # Pod network CIDR to allow access from
  # Default is 10.244.0.0/16 for Calico - verify this matches your cluster's pod network
  # Other common ranges: 10.32.0.0/12 (kube-router), 10.200.0.0/16 (kubenet)
  # If empty, allows access from any address
  podCIDR: "10.244.0.0/16"
