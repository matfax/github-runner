{
  "extends": [
    "config:best-practices",
    "group:allDigest",
    "mergeConfidence:all-badges",
    ":automergePr",
    ":approveMajorUpdates",
    ":automergeTesters",
    ":enableVulnerabilityAlertsWithAdditionalLabel(security)",
    ":gitSignOff"
  ],
  "customManagers": [
    {
      "customType": "regex",
      "managerFilePatterns": [
        "windows/Dockerfile",
        "docker-dind/Dockerfile"
      ],
      "matchStrings": [
        "choco install (?<depName>\\S+)[^\\r\\n]*?(--?\\w+[^\\r\\n]+)*--version[= ](?<currentValue>\\S+)"
      ],
      "datasourceTemplate": "nuget",
      "versioningTemplate": "nuget",
      "registryUrlTemplate": "https://community.chocolatey.org/api/v2/"
    },
    {
      "customType": "regex",
      "description": "Update OCI base image label alongside FROM",
      "managerFilePatterns": [
        "(^|/)Dockerfile$"
      ],
      "matchStrings": [
        "org\\.opencontainers\\.image\\.base\\.name=\"(?<depName>[\\w./-]+):(?<currentValue>[\\w.-]+)\""
      ],
      "datasourceTemplate": "docker",
      "versioningTemplate": "docker"
    },
    {
      "customType": "regex",
      "description": "Update GitHub release versions from ARGs ending with _GITHUB_VERSION",
      "managerFilePatterns": [
        "**/Dockerfile"
      ],
      "matchStrings": [
        "ARG \\w+?_GITHUB_VERSION=(?<currentValue>[^\\s#]+)\\s+#\\s*repository:\\s*(?<depName>[\\w./-]+)"
      ],
      "datasourceTemplate": "github-releases",
      "extractVersionTemplate": "^v?(\\?<version>.+)$"
    },
    {
      "customType": "regex",
      "description": "Update docker-engine version in build.yml",
      "managerFilePatterns": [
        ".github/workflows/build.yml"
      ],
      "matchStrings": [
        "DOCKERD_VERSION:\\s*(?<currentValue>[^\\s#]+)"
      ],
      "datasourceTemplate": "nuget",
      "depNameTemplate": "docker-engine",
      "registryUrlTemplate": "https://community.chocolatey.org/api/v2/",
      "versioningTemplate": "nuget"
    },
    {
      "customType": "regex",
      "description": "Update docker-engine appVersion in Helm Chart.yaml to match choco package",
      "managerFilePatterns": [
        "docker-dind/chart/Chart.yaml"
      ],
      "matchStrings": [
        "appVersion:\\s*\"(?<currentValue>[^\"]+)\""
      ],
      "datasourceTemplate": "nuget",
      "depNameTemplate": "docker-engine",
      "registryUrlTemplate": "https://community.chocolatey.org/api/v2/",
      "versioningTemplate": "nuget"
    }
  ],
  "packageRules": [
    {
      "matchDepNames": ["docker-engine"],
      "groupName": "docker-engine version"
    }
  ]
}
